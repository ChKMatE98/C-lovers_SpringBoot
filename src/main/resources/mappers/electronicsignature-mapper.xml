<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ElectronicSignature">
	<!-- 전자결재 매퍼 -->
	<!-- // 멤버의 전자 결재를 위한 전자선 정렬 -> job_id의 순서대로 정렬 -->
	<select id="selectEmpJobLevel" resultType="map">
		select *
		from emp_job_sec_level
		where id in
		<foreach item="item" collection="list" open="(" separator=","
			close=")">
			#{item}
		</foreach>
	</select>
	
	<!-- // 휴가 문서 생성 -->
	<insert id="insertVacation" useGeneratedKeys="true" keyProperty="id">
		insert into vacation_document (emp_id, report_date) values (#{emp_id}, convert_tz(now(), '+00:00', '+09:00'));
	</insert>
	
	<!-- // 휴가 결재선 등록 -->
	<insert id="insertVacationApprovals" parameterType="java.util.List">
		insert into vacation_emp_approvals (vacation_document_id, emp_approvals_id) values 
		<foreach collection="list" item="empApprovals" separator=",">
			(#{empApprovals.vacation_document_id}, #{empApprovals.emp_approvals_id})
		</foreach>
	</insert>
	
	<!-- // 휴가 신청일 정보 등록 -->
	<insert id="insertVacationApplicationInfo" parameterType="java.util.List">
		insert into vacation_application_info (vacation_document_id, vacation_date, rest_reson_type, vacation_reason) values
		<foreach collection="list" item="vacationInfo" separator=",">
			(#{vacationInfo.vacation_document_id}, #{vacationInfo.vacation_date}, #{vacationInfo.rest_reson_type},#{vacationInfo.vacation_reason})
		</foreach>
	</insert>
	
	<!-- // 진행 중인 문서 전체 리스트 출력 -->
	<select id="progressTotalList" resultType="map">
		select document_id, title, drafter_name, report_date, status from document_list_info where (approver_id = #{loginID} or drafter_id = #{loginID}) and status = '대기'
	</select>
</mapper>